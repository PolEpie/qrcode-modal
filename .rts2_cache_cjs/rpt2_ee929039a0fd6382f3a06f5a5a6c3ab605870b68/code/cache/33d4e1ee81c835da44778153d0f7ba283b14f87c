{"code":"import * as React from \"react\";\r\nimport { isMobile, isAndroid, formatIOSMobile, saveMobileLinkInfo, getMobileLinkRegistry, getWalletRegistryUrl, formatMobileRegistry, } from \"@walletconnect/browser-utils\";\r\nimport Header from \"./Header\";\r\nimport LinkDisplay from \"./LinkDisplay\";\r\nimport QRCodeDisplay from \"./QRCodeDisplay\";\r\nimport { WALLETCONNECT_MODAL_ID } from \"../constants\";\r\nfunction Modal(props) {\r\n    const android = isAndroid();\r\n    const mobile = isMobile();\r\n    const whitelist = mobile\r\n        ? props.qrcodeModalOptions && props.qrcodeModalOptions.mobileLinks\r\n            ? props.qrcodeModalOptions.mobileLinks\r\n            : undefined\r\n        : props.qrcodeModalOptions && props.qrcodeModalOptions.desktopLinks\r\n            ? props.qrcodeModalOptions.desktopLinks\r\n            : undefined;\r\n    const [loading, setLoading] = React.useState(false);\r\n    const [fetched, setFetched] = React.useState(false);\r\n    const [displayQRCode, setDisplayQRCode] = React.useState(!mobile);\r\n    const displayProps = {\r\n        mobile,\r\n        text: props.text,\r\n        uri: props.uri,\r\n        qrcodeModalOptions: props.qrcodeModalOptions,\r\n    };\r\n    const [singleLinkHref, setSingleLinkHref] = React.useState(\"\");\r\n    const [hasSingleLink, setHasSingleLink] = React.useState(false);\r\n    const [links, setLinks] = React.useState([]);\r\n    const [errorMessage, setErrorMessage] = React.useState(\"\");\r\n    const getLinksIfNeeded = () => {\r\n        if (fetched || loading || (whitelist && !whitelist.length) || links.length > 0) {\r\n            return;\r\n        }\r\n        React.useEffect(() => {\r\n            const initLinks = async () => {\r\n                if (android)\r\n                    return;\r\n                setLoading(true);\r\n                try {\r\n                    const url = props.qrcodeModalOptions && props.qrcodeModalOptions.registryUrl\r\n                        ? props.qrcodeModalOptions.registryUrl\r\n                        : getWalletRegistryUrl();\r\n                    const registryResponse = await fetch(url);\r\n                    const registry = (await registryResponse.json()).listings;\r\n                    const platform = mobile ? \"mobile\" : \"desktop\";\r\n                    const _links = getMobileLinkRegistry(formatMobileRegistry(registry, platform), whitelist);\r\n                    setLoading(false);\r\n                    setFetched(true);\r\n                    setErrorMessage(!_links.length ? props.text.no_supported_wallets : \"\");\r\n                    setLinks(_links);\r\n                    const hasSingleLink = _links.length === 1;\r\n                    if (hasSingleLink) {\r\n                        setSingleLinkHref(formatIOSMobile(props.uri, _links[0]));\r\n                        setDisplayQRCode(true);\r\n                    }\r\n                    setHasSingleLink(hasSingleLink);\r\n                }\r\n                catch (e) {\r\n                    setLoading(false);\r\n                    setFetched(true);\r\n                    setErrorMessage(props.text.something_went_wrong);\r\n                    console.error(e);\r\n                }\r\n            };\r\n            initLinks();\r\n        });\r\n    };\r\n    getLinksIfNeeded();\r\n    const rightSelected = mobile ? displayQRCode : !displayQRCode;\r\n    return (React.createElement(\"div\", { id: WALLETCONNECT_MODAL_ID, className: \"walletconnect-qrcode__base animated fadeIn\" },\r\n        React.createElement(\"div\", { className: \"walletconnect-modal__base\" },\r\n            React.createElement(Header, { onClose: props.onClose }),\r\n            hasSingleLink && displayQRCode ? (React.createElement(\"div\", { className: \"walletconnect-modal__single_wallet\" },\r\n                React.createElement(\"a\", { onClick: () => saveMobileLinkInfo({ name: links[0].name, href: singleLinkHref }), href: singleLinkHref, rel: \"noopener noreferrer\", target: \"_blank\" }, props.text.connect_with + \" \" + (hasSingleLink ? links[0].name : \"\") + \" â€º\"))) : android || loading || (!loading && links.length) ? (React.createElement(\"div\", { className: `walletconnect-modal__mobile__toggle${rightSelected ? \" right__selected\" : \"\"}` },\r\n                React.createElement(\"div\", { className: \"walletconnect-modal__mobile__toggle_selector\" }),\r\n                mobile ? (React.createElement(React.Fragment, null,\r\n                    React.createElement(\"a\", { onClick: () => (setDisplayQRCode(false), getLinksIfNeeded()) }, props.text.mobile),\r\n                    React.createElement(\"a\", { onClick: () => setDisplayQRCode(true) }, props.text.qrcode))) : (React.createElement(React.Fragment, null,\r\n                    React.createElement(\"a\", { onClick: () => setDisplayQRCode(true) }, props.text.qrcode),\r\n                    React.createElement(\"a\", { onClick: () => (setDisplayQRCode(false), getLinksIfNeeded()) }, props.text.desktop))))) : null,\r\n            React.createElement(\"div\", null, displayQRCode || (!android && !loading && !links.length) ? (React.createElement(QRCodeDisplay, { ...displayProps })) : (React.createElement(LinkDisplay, { ...displayProps, links: links, errorMessage: errorMessage, onClick: props.onClick }))))));\r\n}\r\nexport default Modal;\r\n//# sourceMappingURL=Modal.js.map","map":"{\"version\":3,\"file\":\"Modal.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../src/browser/components/Modal.tsx\"],\"names\":[],\"mappings\":\"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\"}","dtsmap":{"name":"/Users/polepie/developpement/walletconnect-monorepo-1.0/packages/helpers/qrcode-modal/browser/components/Modal.d.ts.map","writeByteOrderMark":false,"text":"{\"version\":3,\"file\":\"Modal.d.ts\",\"sourceRoot\":\"\",\"sources\":[\"../../src/browser/components/Modal.tsx\"],\"names\":[],\"mappings\":\";AACA,OAAO,EAEL,mBAAmB,EAGpB,MAAM,sBAAsB,CAAC;AAmB9B,OAAO,EAAE,OAAO,EAAE,MAAM,UAAU,CAAC;AAEnC,UAAU,UAAU;IAClB,IAAI,EAAE,OAAO,CAAC;IACd,GAAG,EAAE,MAAM,CAAC;IACZ,OAAO,EAAE,GAAG,CAAC;IACb,OAAO,EAAE,GAAG,CAAC;IACb,kBAAkB,CAAC,EAAE,mBAAmB,CAAC;CAC1C;AAED,iBAAS,KAAK,CAAC,KAAK,EAAE,UAAU,eAsH/B;AAED,eAAe,KAAK,CAAC\"}"},"dts":{"name":"/Users/polepie/developpement/walletconnect-monorepo-1.0/packages/helpers/qrcode-modal/browser/components/Modal.d.ts","writeByteOrderMark":false,"text":"/// <reference types=\"react\" />\r\nimport { IQRCodeModalOptions } from \"@walletconnect/types\";\r\nimport { TextMap } from \"../types\";\r\ninterface ModalProps {\r\n    text: TextMap;\r\n    uri: string;\r\n    onClose: any;\r\n    onClick: any;\r\n    qrcodeModalOptions?: IQRCodeModalOptions;\r\n}\r\ndeclare function Modal(props: ModalProps): JSX.Element;\r\nexport default Modal;\r\n//# sourceMappingURL=Modal.d.ts.map"}}
